(()=>{var e={};e.id=248,e.ids=[248],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},24855:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=s(67096),a=s(16132),l=s(37284),i=s.n(l),n=s(32564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let c=["",{children:["projects",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,57991)),"/Users/shreyansh/ItsMightHappenApp/apps/web/app/projects/new/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,44599)),"/Users/shreyansh/ItsMightHappenApp/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,44293)),"/Users/shreyansh/ItsMightHappenApp/apps/web/app/not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/shreyansh/ItsMightHappenApp/apps/web/app/projects/new/page.tsx"],p="/projects/new/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/projects/new/page",pathname:"/projects/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},81036:(e,t,s)=>{Promise.resolve().then(s.bind(s,79776))},79776:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>NewProjectPage});var r=s(30784),a=s(9885),l=s(83296),i=s(57114),n=s(6568),o=s(66262);function FileUpload({researchPostId:e,onUploadComplete:t}){let s=(0,n.Wq)(),[l,i]=(0,a.useState)(!1),[o,c]=(0,a.useState)(null),[d,p]=(0,a.useState)(null),handleFileUpload=async r=>{if(!r.target.files||0===r.target.files.length)return;let a=r.target.files[0];p(null),c(null);try{i(!0);let{data:{user:r}}=await s.auth.getUser();if(!r)throw Error("Not authenticated");let l=a.name.split(".").pop(),n=`${Math.random().toString(36).slice(2)}.${l}`,o=`research-posts/${e}/${r.id}/${n}`,{error:c}=await s.storage.from("project_files").upload(o,a,{cacheControl:"3600",upsert:!1});if(c)throw c;p(o);let{error:d}=await s.from("project_files").insert({research_post_id:e,uploader_id:r.id,file_name:a.name,file_path:o,file_type:a.type,file_size:a.size});if(d)throw await s.storage.from("project-files").remove([o]),d;t&&t(o)}catch(e){console.error("File upload error:",e),c(e instanceof Error?e.message:"Failed to upload file")}finally{i(!1)}};return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{htmlFor:`file-upload-${e}`,className:"inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 text-sm cursor-pointer",children:[l?"Uploading...":"Choose File",r.jsx("input",{id:`file-upload-${e}`,type:"file",className:"hidden",onChange:handleFileUpload,disabled:l})]}),d&&(0,r.jsxs)("p",{className:"text-sm text-green-600",children:["Successfully uploaded: ",d.split("/").pop()]}),o&&(0,r.jsxs)("p",{className:"text-sm text-red-500",children:["Error: ",o]})]})}var c=s(85217),d=s(40090),p=s(77971),u=s(79979),h=s(81067);let x=l.z.object({title:l.z.string().min(3,"Title must be at least 3 characters").max(100,"Title must be less than 100 characters"),content:l.z.string().min(20,"Content must be at least 20 characters").max(1e4,"Content must be less than 10000 characters"),visibility:l.z.enum(["public","private","connections"]).default("public"),tags:l.z.array(l.z.string()).optional().default([])});function NewProjectPage(){let e=(0,i.useRouter)(),t=(0,n.Wq)(),{user:s,isLoading:l}=(0,o.tN)(),[m,g]=(0,a.useState)({title:"",content:"",visibility:"public",tags:[]}),[b,f]=(0,a.useState)({}),[y,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(null),[N,_]=(0,a.useState)(null),[P,q]=(0,a.useState)(null),[C,k]=(0,a.useState)("");(0,a.useEffect)(()=>{l||s||e.replace("/login")},[s,l,e]);let handleInputChange=e=>{let{name:t,value:s}=e.target;g(e=>({...e,[t]:s})),b[t]&&f(e=>({...e,[t]:void 0}))},handleTagAdd=()=>{let e=C.trim();e&&!(m.tags||[]).includes(e)&&(m.tags||[]).length<10&&(g(t=>({...t,tags:[...t.tags||[],e]})),k(""),b.tags&&f(e=>({...e,tags:void 0})))},handleTagRemove=e=>{g(t=>({...t,tags:(t.tags||[]).filter(t=>t!==e)}))},validateForm=()=>{let e=x.safeParse(m);if(!e.success){let t={};return e.error.errors.forEach(e=>{e.path[0]&&(t[e.path[0]]=e.message)}),f(t),v("Please correct the errors in the form."),_(null),!1}return f({}),!0},handleSubmitDetails=async e=>{if(e.preventDefault(),v(null),_(null),validateForm()){if(!s){v("User not authenticated. Please log in.");return}j(!0);try{let e={user_id:s.id,title:m.title,content:m.content,visibility:m.visibility,tags:m.tags||[]},{data:r,error:a}=await t.from("research_posts").insert(e).select("id").single();if(a)throw a;if(!r||!r.id)throw Error("Failed to create post or ID missing.");q(r.id),_("Post details saved! You can now upload associated files below.")}catch(e){console.error("Submission error:",e),v(e.message||"Failed to create research post. Please try again.")}finally{j(!1)}}},S="block text-sm font-medium text-gray-200 mb-1.5";return l?r.jsx(h._,{title:"New Post",className:"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-800 min-h-screen text-white flex items-center justify-center",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx(u.dAq,{className:"animate-spin text-researchbee-yellow text-6xl mb-4"}),r.jsx("p",{className:"text-xl text-gray-300",children:"Loading..."})]})}):r.jsx(h._,{title:"Create New Research Post",className:"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-800 min-h-screen text-white flex flex-col items-center justify-center py-8 px-4",children:r.jsx("div",{className:"w-full max-w-3xl",children:(0,r.jsxs)(p.Zb,{className:"glass-card shadow-xl w-full overflow-hidden",children:[(0,r.jsxs)(p.Ol,{className:"pt-8 pb-6 text-center border-b border-white/10",children:[r.jsx(u.UH,{className:"text-5xl text-researchbee-yellow mx-auto mb-4"}),r.jsx(p.ll,{className:"text-3xl sm:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 via-pink-500 to-orange-400",children:"Create New Research Post"}),r.jsx(p.SZ,{className:"text-gray-300 mt-2 text-lg px-4",children:"Share your research ideas, findings, or collaboration requests."})]}),(0,r.jsxs)(p.aY,{className:"p-6 sm:p-8 space-y-6",children:[w&&(0,r.jsxs)("div",{className:"p-4 bg-red-500/20 border border-red-500/40 rounded-lg text-red-200 text-sm backdrop-blur-sm flex items-start space-x-3",children:[r.jsx(u.bcx,{className:"h-5 w-5 flex-shrink-0 mt-0.5 text-red-300"}),(0,r.jsxs)("div",{children:[r.jsx("h5",{className:"font-semibold mb-0.5",children:"Error"}),r.jsx("span",{children:w})]})]}),N&&(0,r.jsxs)("div",{className:"p-4 bg-green-500/20 border border-green-500/40 rounded-lg text-green-200 text-sm backdrop-blur-sm flex items-start space-x-3",children:[r.jsx(u._rq,{className:"h-5 w-5 flex-shrink-0 mt-0.5 text-green-300"}),(0,r.jsxs)("div",{children:[r.jsx("h5",{className:"font-semibold mb-0.5",children:"Success!"}),r.jsx("span",{children:N})]})]}),P?(0,r.jsxs)("div",{className:"space-y-6 text-center",children:[r.jsx("h3",{className:"text-2xl font-semibold text-white",children:"Upload Project Files (Optional)"}),r.jsx("p",{className:"text-gray-300",children:"Your post details have been saved. You can now upload any relevant documents, images, or datasets."}),r.jsx("div",{className:"p-4 rounded-lg bg-black/20 border border-white/10 shadow-md",children:r.jsx(FileUpload,{researchPostId:P,onUploadComplete:e=>{_(`File uploaded: ${e.split("/").pop()}. You can upload more or finish.`)}})}),(0,r.jsxs)(c.z,{onClick:()=>{e.push(P?`/research/${P}`:"/dashboard")},variant:"primary",className:"w-full max-w-xs mx-auto bg-green-500 hover:bg-green-600 text-white py-3 text-base",children:[r.jsx(u._rq,{className:"mr-2"})," Finish & View Post / Go to Dashboard"]})]}):(0,r.jsxs)("form",{onSubmit:handleSubmitDetails,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"title",className:S,children:["Title",r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),r.jsx(d.I,{id:"title",name:"title",value:m.title,onChange:handleInputChange,placeholder:"E.g., AI in Sustainable Agriculture",error:!!b.title,className:"bg-white/5 border-white/20 placeholder-gray-400/60 text-white"}),b.title&&r.jsx("p",{className:"mt-1 text-sm text-red-300",children:b.title})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"content",className:S,children:["Content / Description",r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),r.jsx(d.I,{id:"content",name:"content",type:"textarea",rows:6,value:m.content,onChange:handleInputChange,placeholder:"Describe your project in detail...",error:!!b.content,className:"bg-white/5 border-white/20 placeholder-gray-400/60 text-white"}),b.content&&r.jsx("p",{className:"mt-1 text-sm text-red-300",children:b.content})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"tags",className:S,children:"Tags / Keywords (up to 10)"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(d.I,{id:"tag-input",name:"tag-input",value:C,onChange:e=>{k(e.target.value)},onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),handleTagAdd())},placeholder:"Add relevant tags (e.g., AI, Healthcare)",className:"flex-grow bg-white/5 border-white/20 placeholder-gray-400/60 text-white"}),(0,r.jsxs)(c.z,{type:"button",onClick:handleTagAdd,variant:"secondary",className:"bg-researchbee-yellow/80 hover:bg-researchbee-yellow text-black flex-shrink-0",children:[r.jsx(u.E25,{className:"mr-2"})," Add Tag"]})]}),b.tags&&r.jsx("p",{className:"mt-1 text-sm text-red-300",children:b.tags}),(m.tags||[]).length>0&&r.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:(m.tags||[]).map(e=>(0,r.jsxs)("span",{className:"flex items-center bg-researchbee-yellow/20 text-researchbee-yellow px-3 py-1.5 rounded-full text-xs font-medium backdrop-blur-sm border border-researchbee-yellow/30 shadow-sm transition-all hover:bg-researchbee-yellow/30",children:[e,r.jsx("button",{type:"button",onClick:()=>handleTagRemove(e),className:"ml-2 text-researchbee-yellow/70 hover:text-white focus:outline-none transition-colors",children:r.jsx(u.q5L,{size:14})})]},e))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"visibility",className:S,children:"Visibility"}),(0,r.jsxs)("select",{id:"visibility",name:"visibility",value:m.visibility,onChange:handleInputChange,className:"w-full p-3 rounded-lg bg-white/5 border border-white/20 text-white focus:ring-2 focus:ring-researchbee-yellow focus:border-researchbee-yellow outline-none transition-all duration-150 ease-in-out shadow-sm",children:[r.jsx("option",{value:"public",className:"bg-gray-800 text-white",children:"Public (Visible to everyone)"}),r.jsx("option",{value:"connections",className:"bg-gray-800 text-white",children:"Connections Only (Visible to your matches/connections)"}),r.jsx("option",{value:"private",className:"bg-gray-800 text-white",children:"Private (Only visible to you)"})]})]}),(0,r.jsxs)(c.z,{type:"submit",disabled:y,className:"w-full bg-researchbee-yellow hover:bg-researchbee-darkyellow text-black py-3 text-base font-semibold tracking-wide flex items-center justify-center",children:[y?r.jsx(u.dAq,{className:"animate-spin mr-2"}):r.jsx(u.mW3,{className:"mr-2"}),y?"Saving Details...":"Save Post Details"]})]})]})]})})})}},81067:(e,t,s)=>{"use strict";s.d(t,{_:()=>PageContainer});var r=s(30784);s(9885);var a=s(71298),l=s.n(a);function PageContainer({title:e,children:t,className:s}){return(0,r.jsxs)(r.Fragment,{children:[r.jsx(l(),{children:r.jsx("title",{children:`${e} | ResearchCollab`})}),r.jsx("main",{className:`container mx-auto px-4 py-8 ${s||""}`,children:t})]})}},71298:(e,t)=>{"use strict";function NoopHead(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return NoopHead}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},57991:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>o});var r=s(95153);let a=(0,r.createProxy)(String.raw`/Users/shreyansh/ItsMightHappenApp/apps/web/app/projects/new/page.tsx`),{__esModule:l,$$typeof:i}=a,n=a.default,o=n},57114:(e,t,s)=>{e.exports=s(4979)}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[998,450,979,781,505,217,677,971,90],()=>__webpack_exec__(24855));module.exports=s})();