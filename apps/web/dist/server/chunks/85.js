exports.id=85,exports.ids=[85],exports.modules={81067:(e,l,a)=>{"use strict";a.d(l,{_:()=>PageContainer});var t=a(30784);a(9885);var s=a(71298),i=a.n(s);function PageContainer({title:e,children:l,className:a}){return(0,t.jsxs)(t.Fragment,{children:[t.jsx(i(),{children:t.jsx("title",{children:`${e} | ResearchCollab`})}),t.jsx("main",{className:`container mx-auto px-4 py-8 ${a||""}`,children:l})]})}},71798:(e,l,a)=>{"use strict";a.d(l,{r:()=>ProfileForm});var t=a(30784),s=a(9885),i=a(6568),r=a(57114),n=a(85217),o=a(40090),d=a(66262),c=a(54049),u=a(79979),h=a(47723);function ProfileForm({initialData:e,onProfileUpdate:l}){let a=(0,r.useRouter)(),m=(0,i.Wq)(),{user:b,setProfile:p}=(0,d.tN)(),[f,x]=(0,s.useState)(!1),[v,g]=(0,s.useState)(null),[_,y]=(0,s.useState)(null),[j,w]=(0,s.useState)({full_name:e?.full_name||"",bio:e?.bio||"",institution:e?.institution||"",research_interests:e?.research_interests||[],skills:e?.skills||[],collaboration_pitch:e?.collaboration_pitch||"",location:e?.location||"",field_of_study:e?.field_of_study||"",availability:e?.availability||"full-time",website:e?.website||""}),[N,k]=(0,s.useState)(null),[C,I]=(0,s.useState)(e?.avatar_url||null),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{e&&(w({full_name:e.full_name||"",bio:e.bio||"",institution:e.institution||"",research_interests:e.research_interests||[],skills:e.skills||[],collaboration_pitch:e.collaboration_pitch||"",location:e.location||"",field_of_study:e.field_of_study||"",availability:e.availability||"full-time",website:e.website||""}),e.avatar_url&&I(e.avatar_url))},[e]);let handleInputChange=e=>{let{name:l,value:a}=e.target;w(e=>({...e,[l]:a}))},handleSubmit=async e=>{e.preventDefault(),g(null),y(null),x(!0);try{if(!b)throw Error("Not authenticated");let e=j.full_name.trim().split(/\s+/),t=e[0]||"",s=e.slice(1).join(" ")||"",i=C;if(N){let e=await (0,c.gg)(b.id,N);e&&"string"==typeof e.url?i=e.url:console.warn("Avatar upload failed or did not return a URL. Using existing avatar_url or preview.")}let r={id:b.id,user_id:b.id,first_name:t,last_name:s,bio:j.bio,institution:j.institution,interests:j.research_interests,skills:j.skills,collaboration_pitch:j.collaboration_pitch,location:j.location,field_of_study:j.field_of_study,availability:j.availability,website:j.website,avatar_url:i,updated_at:new Date().toISOString()},{data:n,error:o}=await m.from("profiles").upsert(r).select("id, user_id, first_name, last_name, email, avatar_url, institution, bio, website, skills, interests, collaboration_pitch, location, field_of_study, availability, updated_at").single();if(o)throw o;if(y("Profile saved successfully!"),n){let e={id:n.id,user_id:n.user_id,first_name:n.first_name??null,last_name:n.last_name??null,email:n.email??null,avatar_url:n.avatar_url??null,institution:n.institution??null,bio:n.bio??null,website:n.website??null,skills:n.skills??[],interests:n.interests??[],collaboration_pitch:n.collaboration_pitch??null,location:n.location??null,field_of_study:n.field_of_study??null,availability:n.availability,updated_at:n.updated_at?new Date(n.updated_at):null};p(e)}else o||console.warn("Profile upsert successful but no data returned.");l&&l(),a.refresh()}catch(e){g(e instanceof Error?e.message:"An unexpected error occurred. Please try again.")}finally{x(!1)}},handleInterestAdd=e=>{let l=e.trim();l&&!j.research_interests.includes(l)&&w(e=>({...e,research_interests:[...e.research_interests,l]}))},handleInterestRemove=e=>{w(l=>({...l,research_interests:l.research_interests.filter(l=>l!==e)}))},handleSkillAdd=e=>{let l=e.trim();l&&!j.skills.includes(l)&&w(e=>({...e,skills:[...e.skills,l]}))},handleSkillRemove=e=>{w(l=>({...l,skills:l.skills.filter(l=>l!==e)}))},P="block text-sm font-medium text-gray-200 mb-1.5",F="w-full",A="flex items-center bg-purple-600/70 text-white px-3 py-1.5 rounded-full text-xs font-medium backdrop-blur-sm border border-purple-500/50 shadow-sm",R="ml-2 text-purple-200 hover:text-white focus:outline-none";return(0,t.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[t.jsx("div",{className:"w-32 h-32 rounded-full bg-white/10 backdrop-blur-md border border-white/20 flex items-center justify-center overflow-hidden shadow-lg",children:t.jsx(h.q,{src:C,alt:"Profile Avatar",size:"xl",fallback:t.jsx(u.fzv,{className:"text-gray-400",size:60})})}),t.jsx(n.z,{type:"button",variant:"glass",size:"sm",className:"absolute -bottom-2 -right-2 !p-2 rounded-full shadow-md",onClick:()=>S.current?.click(),"aria-label":"Change profile photo",children:t.jsx(u.Yjd,{size:16})})]}),t.jsx("input",{type:"file",ref:S,className:"hidden",accept:"image/*",onChange:e=>{let l=e.target.files?.[0];if(!l)return;let a=new FileReader;a.onloadend=()=>{I(a.result)},a.readAsDataURL(l),k(l)}})]}),v&&(0,t.jsxs)("div",{className:"p-3 bg-red-600/40 border border-red-500/60 rounded-lg text-white text-sm backdrop-blur-sm flex items-center space-x-2",children:[t.jsx(u.bcx,{className:"h-5 w-5 flex-shrink-0"}),t.jsx("span",{children:v})]}),_&&(0,t.jsxs)("div",{className:"p-3 bg-green-600/40 border border-green-500/60 rounded-lg text-white text-sm backdrop-blur-sm flex items-center space-x-2",children:[t.jsx(u._rq,{className:"h-5 w-5 flex-shrink-0"}),t.jsx("span",{children:_})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"full_name",className:P,children:"Full Name"}),t.jsx(o.I,{id:"full_name",name:"full_name",value:j.full_name,onChange:handleInputChange,required:!0,placeholder:"e.g., Ada Lovelace",className:F})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"institution",className:P,children:"Institution"}),t.jsx(o.I,{id:"institution",name:"institution",value:j.institution,onChange:handleInputChange,placeholder:"e.g., University of Research",className:F})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"bio",className:P,children:"Bio"}),t.jsx(o.I,{id:"bio",name:"bio",type:"textarea",value:j.bio,onChange:handleInputChange,placeholder:"Tell us about yourself, your research, and what you're looking for...",rows:4,className:F})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"collaboration_pitch",className:P,children:"Collaboration Pitch / Top Project Idea"}),t.jsx(o.I,{id:"collaboration_pitch",name:"collaboration_pitch",type:"textarea",value:j.collaboration_pitch,onChange:handleInputChange,placeholder:"Describe a project you'd love to collaborate on, or an idea you're passionate about (max 1000 chars).",rows:5,maxLength:1e3,className:F}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"This will be shown to others in profile matching."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"location",className:P,children:"Location"}),t.jsx(o.I,{id:"location",name:"location",value:j.location,onChange:handleInputChange,placeholder:"e.g., London, UK",className:F})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"field_of_study",className:P,children:"Primary Field of Study"}),t.jsx(o.I,{id:"field_of_study",name:"field_of_study",value:j.field_of_study,onChange:handleInputChange,placeholder:"e.g., Computational Linguistics",className:F})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"website",className:P,children:"Website/Portfolio"}),t.jsx(o.I,{id:"website",name:"website",type:"url",value:j.website,onChange:handleInputChange,placeholder:"https://your.personal.page",className:F})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"availability",className:P,children:"Availability for Collaboration"}),(0,t.jsxs)("select",{id:"availability",name:"availability",value:j.availability,onChange:handleInputChange,className:"w-full mt-1 block rounded-lg border bg-white/5 backdrop-blur-sm px-4 py-2.5 text-sm text-gray-100 placeholder:text-gray-400 caret-purple-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:border-transparent disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200 ease-in-out border-white/20 hover:border-white/40 h-11",children:[t.jsx("option",{value:"full-time",className:"bg-gray-800 text-white",children:"Full Time"}),t.jsx("option",{value:"part-time",className:"bg-gray-800 text-white",children:"Part Time"}),t.jsx("option",{value:"weekends",className:"bg-gray-800 text-white",children:"Weekends Only"}),t.jsx("option",{value:"not-available",className:"bg-gray-800 text-white",children:"Not Currently Available"})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:P,children:"Skills (Tags)"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-2 min-h-[2.5rem]",children:(j.skills||[]).map(e=>(0,t.jsxs)("span",{className:A,children:[e,t.jsx("button",{type:"button",onClick:()=>handleSkillRemove(e),className:R,"aria-label":`Remove ${e}`,children:t.jsx(u.q5L,{size:14})})]},e))}),t.jsx(o.I,{placeholder:"Add a skill and press Enter",onKeyDown:e=>{if("Enter"===e.key){e.preventDefault();let l=e.target;l.value.trim()&&(handleSkillAdd(l.value.trim()),l.value="")}},className:F}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Clearly list your key skills (e.g., Python, Data Analysis, Grant Writing)."})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:P,children:"Research Interests (Tags)"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-2 min-h-[2.5rem]",children:(j.research_interests||[]).map(e=>(0,t.jsxs)("span",{className:A,children:[e,t.jsx("button",{type:"button",onClick:()=>handleInterestRemove(e),className:R,"aria-label":`Remove ${e}`,children:t.jsx(u.q5L,{size:14})})]},e))}),t.jsx(o.I,{placeholder:"Add an interest and press Enter",onKeyDown:e=>{if("Enter"===e.key){e.preventDefault();let l=e.target;l.value.trim()&&(handleInterestAdd(l.value.trim()),l.value="")}},className:F}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Add relevant keywords or phrases for your research."})]}),t.jsx("div",{className:"pt-4",children:t.jsx(n.z,{type:"submit",variant:"primary",size:"lg",isLoading:f,isFullWidth:!0,leftIcon:t.jsx(u.mW3,{size:18}),className:"transform hover:scale-105 active:scale-95",children:"Save Changes"})})]})}},71298:(e,l)=>{"use strict";function NoopHead(){return null}Object.defineProperty(l,"__esModule",{value:!0}),Object.defineProperty(l,"default",{enumerable:!0,get:function(){return NoopHead}}),("function"==typeof l.default||"object"==typeof l.default&&null!==l.default)&&void 0===l.default.__esModule&&(Object.defineProperty(l.default,"__esModule",{value:!0}),Object.assign(l.default,l),e.exports=l.default)},57114:(e,l,a)=>{e.exports=a(4979)}};