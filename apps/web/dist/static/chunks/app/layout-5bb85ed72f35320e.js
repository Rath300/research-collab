(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4899:function(e,t,r){Promise.resolve().then(r.t.bind(r,2853,23)),Promise.resolve().then(r.bind(r,7970))},7970:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider}});var a=r(7437),s=r(2265),i=r(2445),n=r(4962),o=r(8092);function AuthProvider(e){let{children:t}=e,{setUser:r,setProfile:l,setLoading:u}=(0,n.tN)(),d=(0,i.Wq)();return(0,s.useEffect)(()=>{u(!0);let{data:e}=d.auth.onAuthStateChange(async(e,t)=>{var a;let s=null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null;if(r(s),s)try{let e=await (0,o.Ai)(s.id);l(e)}catch(e){console.error("Error fetching profile in AuthProvider:",e),l(null)}else l(null);u(!1)}),checkInitialSession=async()=>{var e;let{data:{session:t}}=await d.auth.getSession(),a=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null;if(r(a),a)try{let e=await (0,o.Ai)(a.id);l(e)}catch(e){console.error("Error fetching profile on initial check:",e),l(null)}else l(null);u(!1)};return checkInitialSession(),()=>{var t;null===(t=e.subscription)||void 0===t||t.unsubscribe()}},[d,r,l,u]),(0,a.jsx)(a.Fragment,{children:t})}},8092:function(e,t,r){"use strict";r.d(t,{Ai:function(){return getProfile},ck:function(){return updateProfile},gg:function(){return uploadAvatar}});var a=r(8449),s=r(4683);let i=a.z.object({id:a.z.string().uuid(),first_name:a.z.string().min(1,"First name is required"),last_name:a.z.string().min(1,"Last name is required"),avatar_url:a.z.string().url().nullable(),bio:a.z.string().max(500,"Bio must be less than 500 characters").nullable(),title:a.z.string().nullable(),institution:a.z.string().nullable(),location:a.z.string().nullable(),email:a.z.string().email("Invalid email address").nullable(),website:a.z.string().url("Invalid URL").nullable(),availability:a.z.enum(["full-time","part-time","weekends","not-available"]).nullable(),field_of_study:a.z.string().nullable(),interests:a.z.array(a.z.string()).nullable(),education:a.z.array(a.z.object({degree:a.z.string(),institution:a.z.string(),year:a.z.string()})).nullable(),joining_date:a.z.string().datetime(),created_at:a.z.string().datetime(),updated_at:a.z.string().datetime()});a.z.object({id:a.z.string().uuid(),title:a.z.string().min(3,"Title must be at least 3 characters"),content:a.z.string().min(10,"Content must be at least 10 characters"),user_id:a.z.string().uuid(),tags:a.z.array(a.z.string()).nullable(),visibility:a.z.enum(["public","private","connections"]),is_boosted:a.z.boolean(),engagement_count:a.z.number().int(),created_at:a.z.string().datetime(),updated_at:a.z.string().datetime()}),a.z.object({id:a.z.string().uuid(),user_id_1:a.z.string().uuid(),user_id_2:a.z.string().uuid(),status:a.z.enum(["pending","matched","rejected"]),created_at:a.z.string().datetime(),updated_at:a.z.string().datetime()}),a.z.object({id:a.z.string().uuid(),match_id:a.z.string().uuid(),sender_id:a.z.string().uuid(),receiver_id:a.z.string().uuid(),content:a.z.string().min(1,"Message cannot be empty"),is_read:a.z.boolean(),created_at:a.z.string().datetime()}),a.z.object({email:a.z.string().email("Invalid email address"),password:a.z.string().min(8,"Password must be at least 8 characters"),confirmPassword:a.z.string(),firstName:a.z.string().min(1,"First name is required"),lastName:a.z.string().min(1,"Last name is required"),agreeToTerms:a.z.boolean().refine(e=>!0===e,"You must agree to the terms and conditions")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),a.z.object({email:a.z.string().email("Invalid email address"),password:a.z.string().min(1,"Password is required")}),a.z.object({title:a.z.string().min(3,"Title must be at least 3 characters"),content:a.z.string().min(10,"Content must be at least 10 characters"),tags:a.z.array(a.z.string()).optional(),visibility:a.z.enum(["public","private","connections"]).default("public")}),i.partial().omit({id:!0,created_at:!0,updated_at:!0,joining_date:!0}),a.z.object({id:a.z.string(),user_id:a.z.string(),type:a.z.enum(["message","match","system","mention"]),title:a.z.string(),body:a.z.string(),link:a.z.string().url().nullable(),is_read:a.z.boolean().default(!1),created_at:a.z.string()});let SupabaseError=class SupabaseError extends Error{constructor(e,t=400,r){super(e),this.name="SupabaseError",this.status=t,this.code=r}};let n="https://yltnvmypasnfdgtnyhwg.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlsdG52bXlwYXNuZmRndG55aHdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzNDcxNTMsImV4cCI6MjA1OTkyMzE1M30.ajCPb95af8_It1m_D4yGJhErKuLEtqqfqk8Yq2n4MCw";n&&o||console.error("Missing Supabase environment variables");let l=null;function getBrowserClient(){return l||(l=function(){if(!n||!o)throw new SupabaseError("Missing Supabase environment variables for client",500);return(0,s.eI)(n,o,{auth:{persistSession:!0,autoRefreshToken:!0}})}())}let getProfile=async e=>{let t=getBrowserClient();try{let{data:r,error:a}=await t.from("profiles").select("*").eq("id",e).single();if(a){if("PGRST116"===a.code)return null;throw new SupabaseError("Error fetching profile: ".concat(a.message),a.code?parseInt(a.code):500,a.code)}return i.parse(r)}catch(e){if(console.error("Error in getProfile:",e),e instanceof SupabaseError)throw e;if(e instanceof a.z.ZodError)throw new SupabaseError("Profile data validation failed: ".concat(e.errors.map(e=>e.message).join(", ")),400);throw new SupabaseError(e.message||"Failed to get profile",(null==e?void 0:e.status)||500)}},updateProfile=async(e,t)=>{let r=getBrowserClient(),s=i.partial().omit({id:!0,created_at:!0,updated_at:!0,joining_date:!0}).parse(t),n={...s,updated_at:new Date().toISOString()};try{let{data:t,error:a}=await r.from("profiles").update(n).eq("id",e).select().single();if(a)throw new SupabaseError("Error updating profile: ".concat(a.message),a.code?parseInt(a.code):500,a.code);if(!t)throw new SupabaseError("No data returned after updating profile",500);return i.parse(t)}catch(e){if(console.error("Error in updateProfile:",e),e instanceof SupabaseError)throw e;if(e instanceof a.z.ZodError)throw new SupabaseError("Updated profile data validation failed: ".concat(e.errors.map(e=>e.message).join(", ")),400);throw new SupabaseError(e.message||"Failed to update profile",(null==e?void 0:e.status)||500)}},uploadAvatar=async(e,t)=>{if(!t)return null;let r=t.name.split(".").pop(),a="".concat(e,"-").concat(Date.now(),".").concat(r),s=getBrowserClient();try{let{data:e,error:r}=await s.storage.from("avatars").upload(a,t,{cacheControl:"3600",upsert:!1});if(r)throw new SupabaseError("Avatar upload failed: ".concat(r.message),(null==r?void 0:r.statusCode)||500);if(!e||!e.path)throw new SupabaseError("Avatar upload failed to return a path.",500);let{data:i}=s.storage.from("avatars").getPublicUrl(e.path);return{path:e.path,url:i.publicUrl}}catch(e){if(console.error("Error uploading avatar in API wrapper:",e),e instanceof SupabaseError)throw e;throw new SupabaseError(e.message||"Failed to upload avatar",(null==e?void 0:e.status)||500)}}},4962:function(e,t,r){"use strict";r.d(t,{tN:function(){return s}});var a=r(3265);let s=(0,a.Ue)(e=>({user:null,profile:null,isLoading:!0,setUser:t=>e({user:t}),setProfile:t=>e({profile:t}),setLoading:t=>e({isLoading:t}),signOut:()=>e({user:null,profile:null,isLoading:!1}),clearAuth:()=>e({user:null,profile:null,isLoading:!1})}));(0,a.Ue)(e=>({swipedUsers:[],likedUsers:[],matches:[],addSwipedUser:t=>e(e=>({swipedUsers:[...e.swipedUsers,t]})),addLikedUser:t=>e(e=>({likedUsers:[...e.likedUsers,t]})),setMatches:t=>e({matches:t}),addMatch:t=>e(e=>({matches:[...e.matches,t]})),resetSwipeState:()=>e({swipedUsers:[],likedUsers:[]})})),(0,a.Ue)(e=>({currentChatUserId:null,unreadMessages:{},setCurrentChatUserId:t=>e({currentChatUserId:t}),setUnreadCount:(t,r)=>e(e=>({unreadMessages:{...e.unreadMessages,[t]:r}})),incrementUnreadCount:t=>e(e=>({unreadMessages:{...e.unreadMessages,[t]:(e.unreadMessages[t]||0)+1}})),resetUnreadCount:t=>e(e=>({unreadMessages:{...e.unreadMessages,[t]:0}}))})),(0,a.Ue)(e=>({sidebarOpen:!1,darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches,toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setSidebarOpen:t=>e({sidebarOpen:t}),toggleDarkMode:()=>e(e=>({darkMode:!e.darkMode})),setDarkMode:t=>e({darkMode:t})})),(0,a.Ue)(e=>({posts:[],isLoading:!1,hasMore:!0,setPosts:t=>e({posts:t}),appendPosts:t=>e(e=>({posts:[...e.posts,...t]})),setLoading:t=>e({isLoading:t}),setHasMore:t=>e({hasMore:t}),resetPosts:()=>e({posts:[],hasMore:!0})}))},2445:function(e,t,r){"use strict";r.d(t,{Wq:function(){return getBrowserClient}});var a=r(4683);let SupabaseError=class SupabaseError extends Error{constructor(e,t=400,r){super(e),this.name="SupabaseError",this.status=t,this.code=r}};let s="https://yltnvmypasnfdgtnyhwg.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlsdG52bXlwYXNuZmRndG55aHdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzNDcxNTMsImV4cCI6MjA1OTkyMzE1M30.ajCPb95af8_It1m_D4yGJhErKuLEtqqfqk8Yq2n4MCw";s&&i||console.error("Missing Supabase environment variables");let n=null;function getBrowserClient(){return n||(n=function(){if(!s||!i)throw new SupabaseError("Missing Supabase environment variables",500);return(0,a.eI)(s,i,{auth:{persistSession:!0,autoRefreshToken:!0}})}())}},2853:function(){}},function(e){e.O(0,[358,588,971,472,744],function(){return e(e.s=4899)}),_N_E=e.O()}]);