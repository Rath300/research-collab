(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[248],{7864:function(e,t,r){Promise.resolve().then(r.bind(r,7303))},7303:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return NewProjectPage}});var s=r(7437),a=r(2265),l=r(8449),n=r(4033),i=r(2445),o=r(4962);function FileUpload(e){let{researchPostId:t,onUploadComplete:r}=e,l=(0,i.Wq)(),[n,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),handleFileUpload=async e=>{if(!e.target.files||0===e.target.files.length)return;let s=e.target.files[0];h(null),c(null);try{o(!0);let{data:{user:e}}=await l.auth.getUser();if(!e)throw Error("Not authenticated");let a=s.name.split(".").pop(),n="".concat(Math.random().toString(36).slice(2),".").concat(a),i="research-posts/".concat(t,"/").concat(e.id,"/").concat(n),{error:d}=await l.storage.from("project_files").upload(i,s,{cacheControl:"3600",upsert:!1});if(d)throw d;h(i);let{error:c}=await l.from("project_files").insert({research_post_id:t,uploader_id:e.id,file_name:s.name,file_path:i,file_type:s.type,file_size:s.size});if(c)throw await l.storage.from("project-files").remove([i]),c;r&&r(i)}catch(e){console.error("File upload error:",e),c(e instanceof Error?e.message:"Failed to upload file")}finally{o(!1)}};return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{htmlFor:"file-upload-".concat(t),className:"inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 text-sm cursor-pointer",children:[n?"Uploading...":"Choose File",(0,s.jsx)("input",{id:"file-upload-".concat(t),type:"file",className:"hidden",onChange:handleFileUpload,disabled:n})]}),u&&(0,s.jsxs)("p",{className:"text-sm text-green-600",children:["Successfully uploaded: ",u.split("/").pop()]}),d&&(0,s.jsxs)("p",{className:"text-sm text-red-500",children:["Error: ",d]})]})}var d=r(2247),c=r(4977),u=r(1844),h=r(231),m=r(1407);let b=l.z.object({title:l.z.string().min(3,"Title must be at least 3 characters").max(100,"Title must be less than 100 characters"),content:l.z.string().min(20,"Content must be at least 20 characters").max(1e4,"Content must be less than 10000 characters"),visibility:l.z.enum(["public","private","connections"]).default("public"),tags:l.z.array(l.z.string()).optional().default([])});function NewProjectPage(){let e=(0,n.useRouter)(),t=(0,i.Wq)(),{user:r,isLoading:l}=(0,o.tN)(),[p,g]=(0,a.useState)({title:"",content:"",visibility:"public",tags:[]}),[x,f]=(0,a.useState)({}),[w,v]=(0,a.useState)(!1),[y,j]=(0,a.useState)(null),[N,C]=(0,a.useState)(null),[k,M]=(0,a.useState)(null),[U,S]=(0,a.useState)("");(0,a.useEffect)(()=>{l||r||e.replace("/login")},[r,l,e]);let handleInputChange=e=>{let{name:t,value:r}=e.target;g(e=>({...e,[t]:r})),x[t]&&f(e=>({...e,[t]:void 0}))},handleTagAdd=()=>{let e=U.trim();e&&!(p.tags||[]).includes(e)&&(p.tags||[]).length<10&&(g(t=>({...t,tags:[...t.tags||[],e]})),S(""),x.tags&&f(e=>({...e,tags:void 0})))},handleTagRemove=e=>{g(t=>({...t,tags:(t.tags||[]).filter(t=>t!==e)}))},validateForm=()=>{let e=b.safeParse(p);if(!e.success){let t={};return e.error.errors.forEach(e=>{e.path[0]&&(t[e.path[0]]=e.message)}),f(t),j("Please correct the errors in the form."),C(null),!1}return f({}),!0},handleSubmitDetails=async e=>{if(e.preventDefault(),j(null),C(null),validateForm()){if(!r){j("User not authenticated. Please log in.");return}v(!0);try{let e={user_id:r.id,title:p.title,content:p.content,visibility:p.visibility,tags:p.tags||[]},{data:s,error:a}=await t.from("research_posts").insert(e).select("id").single();if(a)throw a;if(!s||!s.id)throw Error("Failed to create post or ID missing.");M(s.id),C("Post details saved! You can now upload associated files below.")}catch(e){console.error("Submission error:",e),j(e.message||"Failed to create research post. Please try again.")}finally{v(!1)}}},I="block text-sm font-medium text-gray-200 mb-1.5";return l?(0,s.jsx)(m._,{title:"New Post",className:"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-800 min-h-screen text-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)(h.dAq,{className:"animate-spin text-researchbee-yellow text-6xl mb-4"}),(0,s.jsx)("p",{className:"text-xl text-gray-300",children:"Loading..."})]})}):(0,s.jsx)(m._,{title:"Create New Research Post",className:"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-800 min-h-screen text-white flex flex-col items-center justify-center py-8 px-4",children:(0,s.jsx)("div",{className:"w-full max-w-3xl",children:(0,s.jsxs)(u.Zb,{className:"glass-card shadow-xl w-full overflow-hidden",children:[(0,s.jsxs)(u.Ol,{className:"pt-8 pb-6 text-center border-b border-white/10",children:[(0,s.jsx)(h.UH,{className:"text-5xl text-researchbee-yellow mx-auto mb-4"}),(0,s.jsx)(u.ll,{className:"text-3xl sm:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 via-pink-500 to-orange-400",children:"Create New Research Post"}),(0,s.jsx)(u.SZ,{className:"text-gray-300 mt-2 text-lg px-4",children:"Share your research ideas, findings, or collaboration requests."})]}),(0,s.jsxs)(u.aY,{className:"p-6 sm:p-8 space-y-6",children:[y&&(0,s.jsxs)("div",{className:"p-4 bg-red-500/20 border border-red-500/40 rounded-lg text-red-200 text-sm backdrop-blur-sm flex items-start space-x-3",children:[(0,s.jsx)(h.bcx,{className:"h-5 w-5 flex-shrink-0 mt-0.5 text-red-300"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-semibold mb-0.5",children:"Error"}),(0,s.jsx)("span",{children:y})]})]}),N&&(0,s.jsxs)("div",{className:"p-4 bg-green-500/20 border border-green-500/40 rounded-lg text-green-200 text-sm backdrop-blur-sm flex items-start space-x-3",children:[(0,s.jsx)(h._rq,{className:"h-5 w-5 flex-shrink-0 mt-0.5 text-green-300"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-semibold mb-0.5",children:"Success!"}),(0,s.jsx)("span",{children:N})]})]}),k?(0,s.jsxs)("div",{className:"space-y-6 text-center",children:[(0,s.jsx)("h3",{className:"text-2xl font-semibold text-white",children:"Upload Project Files (Optional)"}),(0,s.jsx)("p",{className:"text-gray-300",children:"Your post details have been saved. You can now upload any relevant documents, images, or datasets."}),(0,s.jsx)("div",{className:"p-4 rounded-lg bg-black/20 border border-white/10 shadow-md",children:(0,s.jsx)(FileUpload,{researchPostId:k,onUploadComplete:e=>{C("File uploaded: ".concat(e.split("/").pop(),". You can upload more or finish."))}})}),(0,s.jsxs)(d.z,{onClick:()=>{e.push(k?"/research/".concat(k):"/dashboard")},variant:"primary",className:"w-full max-w-xs mx-auto bg-green-500 hover:bg-green-600 text-white py-3 text-base",children:[(0,s.jsx)(h._rq,{className:"mr-2"})," Finish & View Post / Go to Dashboard"]})]}):(0,s.jsxs)("form",{onSubmit:handleSubmitDetails,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"title",className:I,children:["Title",(0,s.jsx)("span",{className:"text-red-400 ml-1",children:"*"})]}),(0,s.jsx)(c.I,{id:"title",name:"title",value:p.title,onChange:handleInputChange,placeholder:"E.g., AI in Sustainable Agriculture",error:!!x.title,className:"bg-white/5 border-white/20 placeholder-gray-400/60 text-white"}),x.title&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-300",children:x.title})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"content",className:I,children:["Content / Description",(0,s.jsx)("span",{className:"text-red-400 ml-1",children:"*"})]}),(0,s.jsx)(c.I,{id:"content",name:"content",type:"textarea",rows:6,value:p.content,onChange:handleInputChange,placeholder:"Describe your project in detail...",error:!!x.content,className:"bg-white/5 border-white/20 placeholder-gray-400/60 text-white"}),x.content&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-300",children:x.content})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"tags",className:I,children:"Tags / Keywords (up to 10)"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(c.I,{id:"tag-input",name:"tag-input",value:U,onChange:e=>{S(e.target.value)},onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),handleTagAdd())},placeholder:"Add relevant tags (e.g., AI, Healthcare)",className:"flex-grow bg-white/5 border-white/20 placeholder-gray-400/60 text-white"}),(0,s.jsxs)(d.z,{type:"button",onClick:handleTagAdd,variant:"secondary",className:"bg-researchbee-yellow/80 hover:bg-researchbee-yellow text-black flex-shrink-0",children:[(0,s.jsx)(h.E25,{className:"mr-2"})," Add Tag"]})]}),x.tags&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-300",children:x.tags}),(p.tags||[]).length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 pt-2",children:(p.tags||[]).map(e=>(0,s.jsxs)("span",{className:"flex items-center bg-researchbee-yellow/20 text-researchbee-yellow px-3 py-1.5 rounded-full text-xs font-medium backdrop-blur-sm border border-researchbee-yellow/30 shadow-sm transition-all hover:bg-researchbee-yellow/30",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>handleTagRemove(e),className:"ml-2 text-researchbee-yellow/70 hover:text-white focus:outline-none transition-colors",children:(0,s.jsx)(h.q5L,{size:14})})]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"visibility",className:I,children:"Visibility"}),(0,s.jsxs)("select",{id:"visibility",name:"visibility",value:p.visibility,onChange:handleInputChange,className:"w-full p-3 rounded-lg bg-white/5 border border-white/20 text-white focus:ring-2 focus:ring-researchbee-yellow focus:border-researchbee-yellow outline-none transition-all duration-150 ease-in-out shadow-sm",children:[(0,s.jsx)("option",{value:"public",className:"bg-gray-800 text-white",children:"Public (Visible to everyone)"}),(0,s.jsx)("option",{value:"connections",className:"bg-gray-800 text-white",children:"Connections Only (Visible to your matches/connections)"}),(0,s.jsx)("option",{value:"private",className:"bg-gray-800 text-white",children:"Private (Only visible to you)"})]})]}),(0,s.jsxs)(d.z,{type:"submit",disabled:w,className:"w-full bg-researchbee-yellow hover:bg-researchbee-darkyellow text-black py-3 text-base font-semibold tracking-wide flex items-center justify-center",children:[w?(0,s.jsx)(h.dAq,{className:"animate-spin mr-2"}):(0,s.jsx)(h.mW3,{className:"mr-2"}),w?"Saving Details...":"Save Post Details"]})]})]})]})})})}},1407:function(e,t,r){"use strict";r.d(t,{_:function(){return PageContainer}});var s=r(7437);r(2265);var a=r(3574),l=r.n(a);function PageContainer(e){let{title:t,children:r,className:a}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"".concat(t," | ResearchCollab")})}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-8 ".concat(a||""),children:r})]})}},2247:function(e,t,r){"use strict";r.d(t,{z:function(){return i}});var s=r(7437),a=r(2265),l=r(9654),n=r(794);let i=a.forwardRef((e,t)=>{let{children:r,className:a,variant:i="primary",size:o="md",isLoading:d=!1,isFullWidth:c=!1,leftIcon:u,rightIcon:h,disabled:m,...b}=e;return(0,s.jsxs)("button",{ref:t,className:(0,l.m6)((0,n.W)("inline-flex items-center justify-center rounded-lg font-semibold tracking-wide transition-all duration-300 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-transparent disabled:opacity-60 disabled:pointer-events-none",{primary:"bg-gradient-to-r from-purple-600 to-pink-500 text-white hover:from-purple-700 hover:to-pink-600 shadow-lg hover:shadow-xl focus-visible:ring-purple-500",secondary:"bg-gray-700/50 text-gray-100 hover:bg-gray-600/70 backdrop-blur-sm border border-gray-600/80 focus-visible:ring-gray-400",accent:"bg-gradient-to-r from-researchbee-yellow to-orange-500 text-black hover:from-researchbee-yellow-dark hover:to-orange-600 shadow-md hover:shadow-lg focus-visible:ring-researchbee-yellow",outline:"border border-white/30 bg-white/5 text-gray-100 backdrop-blur-sm hover:bg-white/10 hover:border-white/50 hover:text-white focus-visible:ring-white/70",ghost:"bg-transparent text-gray-200 hover:bg-white/10 hover:text-white focus-visible:ring-gray-400",danger:"bg-red-500/70 border border-red-500/90 text-white backdrop-blur-sm hover:bg-red-600/80 hover:border-red-600 focus-visible:ring-red-400",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white hover:bg-white/20 hover:border-white/30 shadow-lg focus-visible:ring-white/50"}[i],{sm:"px-3.5 py-2 text-xs h-9",md:"px-5 py-2.5 text-sm h-10",lg:"px-6 py-3 text-base h-12"}[o],c?"w-full":"",d?"opacity-75 cursor-not-allowed":"",a)),disabled:m||d,...b,children:[d&&(0,s.jsxs)("svg",{className:"animate-spin -ml-0.5 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!d&&u&&(0,s.jsx)("span",{className:r?"mr-2":"",children:u}),r,!d&&h&&(0,s.jsx)("span",{className:r?"ml-2":"",children:h})]})});i.displayName="Button"},1844:function(e,t,r){"use strict";r.d(t,{Ol:function(){return CardHeader},SZ:function(){return CardDescription},Zb:function(){return Card},aY:function(){return CardContent},eW:function(){return CardFooter},ll:function(){return CardTitle}});var s=r(7437);r(2265);var a=r(9654);let Card=e=>{let{children:t,className:r,hoverEffect:l=!1,as:n="div"}=e;return(0,s.jsx)(n,{className:(0,a.m6)("rounded-xl bg-black/20 backdrop-blur-lg border border-white/10 shadow-2xl","p-6",l&&"transition-all duration-300 hover:shadow-purple-500/30 hover:border-white/20 hover:bg-black/30",r),children:t})},CardHeader=e=>{let{children:t,className:r}=e;return(0,s.jsx)("div",{className:(0,a.m6)("pb-4 mb-4 border-b border-white/10",r),children:t})},CardTitle=e=>{let{children:t,className:r}=e;return(0,s.jsx)("h3",{className:(0,a.m6)("text-xl lg:text-2xl font-semibold text-white",r),children:t})},CardDescription=e=>{let{children:t,className:r}=e;return(0,s.jsx)("p",{className:(0,a.m6)("text-sm text-gray-300 leading-relaxed",r),children:t})},CardContent=e=>{let{children:t,className:r}=e;return(0,s.jsx)("div",{className:(0,a.m6)("",r),children:t})},CardFooter=e=>{let{children:t,className:r}=e;return(0,s.jsx)("div",{className:(0,a.m6)("pt-4 mt-4 border-t border-white/10 flex items-center",r),children:t})}},4977:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});var s=r(7437),a=r(2265),l=r(1628);let n=(0,a.forwardRef)((e,t)=>{let{className:r,type:a,...n}=e,i=(0,l.cn)("flex w-full rounded-lg border bg-white/5 backdrop-blur-sm px-4 py-2.5 text-sm text-gray-100 ","placeholder:text-gray-400 caret-purple-400 ","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 focus-visible:border-transparent ","disabled:cursor-not-allowed disabled:opacity-50 ","transition-all duration-200 ease-in-out ",e.error?"border-red-500/70 focus-visible:ring-red-500":"border-white/20 hover:border-white/40",r);return"textarea"===a?(0,s.jsx)("textarea",{className:(0,l.cn)(i,"h-auto min-h-[100px]"),ref:t,...n}):(0,s.jsx)("input",{type:a||"text",className:(0,l.cn)(i,"h-11"),ref:t,...n})});n.displayName="Input"},4962:function(e,t,r){"use strict";r.d(t,{aK:function(){return l},tN:function(){return a}});var s=r(3265);let a=(0,s.Ue)(e=>({user:null,profile:null,isLoading:!0,setUser:t=>e({user:t}),setProfile:t=>e({profile:t}),setLoading:t=>e({isLoading:t}),signOut:()=>e({user:null,profile:null,isLoading:!1}),clearAuth:()=>e({user:null,profile:null,isLoading:!1})}));(0,s.Ue)(e=>({swipedUsers:[],likedUsers:[],matches:[],addSwipedUser:t=>e(e=>({swipedUsers:[...e.swipedUsers,t]})),addLikedUser:t=>e(e=>({likedUsers:[...e.likedUsers,t]})),setMatches:t=>e({matches:t}),addMatch:t=>e(e=>({matches:[...e.matches,t]})),resetSwipeState:()=>e({swipedUsers:[],likedUsers:[],matches:[]})}));let l=(0,s.Ue)((e,t)=>({currentChatUserId:null,unreadMessages:{},totalUnreadMessages:0,setCurrentChatUserId:t=>e({currentChatUserId:t}),setUnreadCount:(r,s)=>{let a=t().unreadMessages[r]||0,l=t().totalUnreadMessages-a+s;e(e=>({unreadMessages:{...e.unreadMessages,[r]:s},totalUnreadMessages:Math.max(0,l)}))},incrementUnreadCount:t=>{e(e=>({unreadMessages:{...e.unreadMessages,[t]:(e.unreadMessages[t]||0)+1},totalUnreadMessages:e.totalUnreadMessages+1}))},resetUnreadCount:r=>{let s=t().unreadMessages[r]||0;e(e=>({unreadMessages:{...e.unreadMessages,[r]:0},totalUnreadMessages:Math.max(0,e.totalUnreadMessages-s)}))},setTotalUnreadMessages:t=>e({totalUnreadMessages:t})}));(0,s.Ue)(e=>({sidebarOpen:!1,darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches,toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setSidebarOpen:t=>e({sidebarOpen:t}),toggleDarkMode:()=>e(e=>({darkMode:!e.darkMode})),setDarkMode:t=>e({darkMode:t})})),(0,s.Ue)(e=>({posts:[],isLoading:!1,hasMore:!0,setPosts:t=>e({posts:t}),appendPosts:t=>e(e=>({posts:[...e.posts,...t]})),setLoading:t=>e({isLoading:t}),setHasMore:t=>e({hasMore:t}),resetPosts:()=>e({posts:[],isLoading:!1,hasMore:!0})}))},2445:function(e,t,r){"use strict";r.d(t,{Wq:function(){return getBrowserClient}});var s=r(4683);let SupabaseError=class SupabaseError extends Error{constructor(e,t=400,r){super(e),this.name="SupabaseError",this.status=t,this.code=r}};let a="https://yltnvmypasnfdgtnyhwg.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlsdG52bXlwYXNuZmRndG55aHdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzNDcxNTMsImV4cCI6MjA1OTkyMzE1M30.ajCPb95af8_It1m_D4yGJhErKuLEtqqfqk8Yq2n4MCw";a&&l||console.error("Missing Supabase environment variables");let n=null;function getBrowserClient(){return n||(n=function(){if(!a||!l)throw new SupabaseError("Missing Supabase environment variables",500);return(0,s.eI)(a,l,{auth:{persistSession:!0,autoRefreshToken:!0}})}())}},1628:function(e,t,r){"use strict";r.d(t,{cn:function(){return cn}});var s=r(794),a=r(9654);function cn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}},3574:function(e,t){"use strict";function NoopHead(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return NoopHead}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4033:function(e,t,r){e.exports=r(94)}},function(e){e.O(0,[238,683,74,588,971,472,744],function(){return e(e.s=7864)}),_N_E=e.O()}]);