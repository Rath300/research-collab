(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{5470:function(e,s,t){Promise.resolve().then(t.bind(t,227))},227:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return DashboardPage}});var a=t(7437),r=t(2265),i=t(4033),l=t(1844),c=t(2247),n=t(231),d=t(4962),o=t(4510),m=t(1654),x=t(1767);function DashboardPage(){let e=(0,i.useRouter)(),{user:s}=(0,d.tN)(),[t,h]=(0,r.useState)({postCount:0,matchCount:0,messageCount:0,viewCount:0}),[u,j]=(0,r.useState)([]),[p,f]=(0,r.useState)([]),[g,N]=(0,r.useState)(!0),b=(0,o.AY)("https://yltnvmypasnfdgtnyhwg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlsdG52bXlwYXNuZmRndG55aHdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzNDcxNTMsImV4cCI6MjA1OTkyMzE1M30.ajCPb95af8_It1m_D4yGJhErKuLEtqqfqk8Yq2n4MCw"),y=(0,r.useCallback)(async()=>{try{if(!s)return;N(!0);let[{count:e},{count:t},{count:a}]=await Promise.all([b.from("research_posts").select("*",{count:"exact",head:!0}).eq("user_id",s.id),b.from("profile_matches").select("*",{count:"exact",head:!0}).eq("matcher_user_id",s.id),b.from("messages").select("*",{count:"exact",head:!0}).or("sender_id.eq.".concat(s.id,",receiver_id.eq.").concat(s.id))]);h({postCount:e||0,matchCount:t||0,messageCount:a||0,viewCount:0});let{data:r,error:i}=await b.from("profile_matches").select("\n          *,\n          matched_profile:profiles!profile_matches_matchee_user_id_fkey (*)\n        ").eq("matcher_user_id",s.id).order("created_at",{ascending:!1}).limit(3);i?console.error("Error fetching matches:",i):j(r);let{data:l,error:c}=await b.from("research_posts").select("\n          *,\n          profiles:user_id (*)\n        ").eq("visibility","public").order("created_at",{ascending:!1}).limit(3);c?console.error("Error fetching posts:",c):f(l||[])}catch(e){console.error("Error loading dashboard data:",e)}finally{N(!1)}},[s,b]);return((0,r.useEffect)(()=>{s?y():g||e.push("/login")},[s,g,y,e]),g)?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})})}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)(l.Zb,{children:(0,a.jsx)(l.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Research Posts"}),(0,a.jsx)("h3",{className:"text-2xl font-bold mt-2",children:t.postCount})]}),(0,a.jsx)("div",{className:"bg-primary-100 p-3 rounded-full dark:bg-primary-900/30",children:(0,a.jsx)(n.l1M,{className:"text-primary-600 dark:text-primary-400",size:24})})]})})}),(0,a.jsx)(l.Zb,{children:(0,a.jsx)(l.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Matches"}),(0,a.jsx)("h3",{className:"text-2xl font-bold mt-2",children:t.matchCount})]}),(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full dark:bg-green-900/30",children:(0,a.jsx)(n.WY8,{className:"text-green-600 dark:text-green-400",size:24})})]})})}),(0,a.jsx)(l.Zb,{children:(0,a.jsx)(l.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Messages"}),(0,a.jsx)("h3",{className:"text-2xl font-bold mt-2",children:t.messageCount})]}),(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full dark:bg-blue-900/30",children:(0,a.jsx)(n.IC0,{className:"text-blue-600 dark:text-blue-400",size:24})})]})})}),(0,a.jsx)(l.Zb,{children:(0,a.jsx)(l.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Profile Views"}),(0,a.jsx)("h3",{className:"text-2xl font-bold mt-2",children:t.viewCount})]}),(0,a.jsx)("div",{className:"bg-purple-100 p-3 rounded-full dark:bg-purple-900/30",children:(0,a.jsx)(n.orK,{className:"text-purple-600 dark:text-purple-400",size:24})})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(l.ll,{children:"Recent Posts"}),(0,a.jsxs)(c.z,{variant:"ghost",onClick:()=>e.push("/research"),children:["View All ",(0,a.jsx)(n.Tfp,{className:"ml-2"})]})]})}),(0,a.jsx)(l.aY,{children:(0,a.jsx)("div",{className:"space-y-6",children:p.length>0?p.map(e=>(0,a.jsx)(m.o,{post:e,onLike:()=>{},onBoost:()=>{}},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No research posts yet"}),(0,a.jsxs)(c.z,{onClick:()=>e.push("/research/new"),children:[(0,a.jsx)(n.OvN,{className:"mr-2"})," Create Post"]})]})})})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(l.ll,{children:"Recent Matches"}),(0,a.jsxs)(c.z,{variant:"ghost",onClick:()=>e.push("/collaborators"),children:["View All ",(0,a.jsx)(n.Tfp,{className:"ml-2"})]})]})}),(0,a.jsx)(l.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:u.length>0?u.map(s=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(x.q,{src:s.matched_profile.avatar_url,alt:"".concat(s.matched_profile.first_name," ").concat(s.matched_profile.last_name),size:"md",fallback:(0,a.jsx)(n.fzv,{className:"text-gray-400",size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 dark:text-white",children:[s.matched_profile.first_name," ",s.matched_profile.last_name]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.matched_profile.title||s.matched_profile.institution||"Researcher"})]})]}),(0,a.jsx)(c.z,{variant:"ghost",onClick:()=>e.push("/profile/".concat(s.matched_profile.id)),children:"View Profile"})]},s.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No matches yet"}),(0,a.jsxs)(c.z,{onClick:()=>e.push("/discover"),children:[(0,a.jsx)(n.jRj,{className:"mr-2"})," Find Collaborators"]})]})})})]})]})]})}}},function(e){e.O(0,[238,683,326,74,691,501,304,65,971,472,744],function(){return e(e.s=5470)}),_N_E=e.O()}]);